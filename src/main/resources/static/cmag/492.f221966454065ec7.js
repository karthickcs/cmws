"use strict";(self.webpackChunkcmag=self.webpackChunkcmag||[]).push([[492],{1492:(S,h,s)=>{s.r(h),s.d(h,{ViewbytranModule:()=>F});var c=s(6895),g=s(646),u=s(7489),t=s(1571),_=s(1137),T=s(2126),Z=s(1679),m=s(9384),d=s(433),y=s(4631),p=s(9061);function f(i,r){1&i&&(t.TgZ(0,"h5")(1,"a",13),t._uU(2,"SEARCH PANEL"),t.qZA()())}function b(i,r){if(1&i&&(t.TgZ(0,"option",26),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.taskid),t.xp6(1),t.AsE(" ",e.taskname," ---\x3e ",e.taskid," ")}}function A(i,r){if(1&i&&(t.TgZ(0,"option",26),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.runid),t.xp6(1),t.hij(" Run Id ---\x3e ",e.runid," ")}}function O(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"label",16),t._uU(3,"Task ID"),t.qZA(),t.TgZ(4,"select",17),t.NdJ("ngModelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.taskid=a)})("ngModelChange",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.loadruniddata(!1))}),t.TgZ(5,"option",18),t._uU(6,"Select Task"),t.qZA(),t.YNc(7,b,2,3,"option",19),t.qZA()()(),t.TgZ(8,"div",14)(9,"div",15)(10,"label",20),t._uU(11,"Run ID"),t.qZA(),t.TgZ(12,"select",21),t.NdJ("ngModelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.runidselect=a)})("ngModelChange",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.loadrunid())}),t.TgZ(13,"option",18),t._uU(14,"Select RunID"),t.qZA(),t.YNc(15,A,2,2,"option",19),t.qZA()()(),t.TgZ(16,"div",22)(17,"table",23)(18,"thead")(19,"tr",24)(20,"th"),t._uU(21,"TaskName"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"TaskId"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"Type"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"Jdbcurlsys1"),t.qZA(),t.TgZ(28,"th"),t._uU(29,"Jdbcurlsys2"),t.qZA(),t.TgZ(30,"th"),t._uU(31,"usernamesys1"),t.qZA(),t.TgZ(32,"th"),t._uU(33,"usernamesys2"),t.qZA(),t.TgZ(34,"th"),t._uU(35,"dbtypesys1"),t.qZA(),t.TgZ(36,"th"),t._uU(37,"tablenamesys1"),t.qZA(),t.TgZ(38,"th"),t._uU(39,"dbtypesys2"),t.qZA(),t.TgZ(40,"th"),t._uU(41,"tablenamesys2"),t.qZA(),t.TgZ(42,"th"),t._uU(43,"RowCount"),t.qZA(),t.TgZ(44,"th"),t._uU(45,"Filelocation1"),t.qZA(),t.TgZ(46,"th"),t._uU(47,"Filelocation2"),t.qZA()()(),t.TgZ(48,"tbody")(49,"tr",25)(50,"td"),t._uU(51),t.qZA(),t.TgZ(52,"td"),t._uU(53),t.qZA(),t.TgZ(54,"td"),t._uU(55),t.qZA(),t.TgZ(56,"td"),t._uU(57),t.qZA(),t.TgZ(58,"td"),t._uU(59),t.qZA(),t.TgZ(60,"td"),t._uU(61),t.qZA(),t.TgZ(62,"td"),t._uU(63),t.qZA(),t.TgZ(64,"td"),t._uU(65),t.qZA(),t.TgZ(66,"td"),t._uU(67),t.qZA(),t.TgZ(68,"td"),t._uU(69),t.qZA(),t.TgZ(70,"td"),t._uU(71),t.qZA(),t.TgZ(72,"td"),t._uU(73),t.qZA(),t.TgZ(74,"td"),t._uU(75),t.qZA(),t.TgZ(76,"td"),t._uU(77),t.qZA()()()()()}if(2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.taskid),t.xp6(3),t.Q6J("ngForOf",e.taskmainArray),t.xp6(5),t.Q6J("ngModel",e.runidselect),t.xp6(3),t.Q6J("ngForOf",e.dplistenArray),t.xp6(36),t.Oqu(e.dplistenentry.taskname),t.xp6(2),t.Oqu(e.dplistenentry.taskid),t.xp6(2),t.Oqu(e.dplistenentry.sys1type),t.xp6(2),t.Oqu(e.dplistenentry.jdbcurlsys1),t.xp6(2),t.Oqu(e.dplistenentry.jdbcurlsys2),t.xp6(2),t.Oqu(e.dplistenentry.usernamesys1),t.xp6(2),t.Oqu(e.dplistenentry.usernamesys2),t.xp6(2),t.Oqu(e.dplistenentry.dbtypesys1),t.xp6(2),t.Oqu(e.dplistenentry.tablenamesys1),t.xp6(2),t.Oqu(e.dplistenentry.dbtypesys2),t.xp6(2),t.Oqu(e.dplistenentry.tablenamesys2),t.xp6(2),t.Oqu(e.dplistenentry.rowcount),t.xp6(2),t.Oqu(e.dplistenentry.filelocation),t.xp6(2),t.Oqu(e.dplistenentry.filelocationt2)}}function x(i,r){if(1&i&&(t.TgZ(0,"h5")(1,"a",13),t._uU(2),t.qZA()()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.key)}}function v(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"h5")(1,"a",13),t._uU(2),t.qZA()(),t.TgZ(3,"i",29),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,o=t.oxw(3);return t.KtG(o.onMaintrainid(a.key,o.dplistenentry.runid,o.dplistenentry.taskid))}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.key.split("|")[1])}}function C(i,r){1&i&&(t.TgZ(0,"thead")(1,"tr",24)(2,"th"),t._uU(3,"#"),t.qZA(),t.TgZ(4,"th",33),t._uU(5,"Base System"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"#"),t.qZA(),t.TgZ(8,"th",33),t._uU(9,"Updated System"),t.qZA()()())}function q(i,r){if(1&i&&(t.TgZ(0,"tr",25)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"input",34),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"input",35),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"input",34),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"input",36),t.qZA()()),2&i){const e=r.$implicit,n=r.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.s9C("value",e.column),t.xp6(2),t.s9C("value",e.oldval),t.xp6(2),t.Oqu(n+1),t.xp6(2),t.s9C("value",e.column),t.xp6(2),t.s9C("value",e.newval)}}function D(i,r){if(1&i&&(t.TgZ(0,"table",30),t.YNc(1,C,10,0,"ng-template",31),t.TgZ(2,"tbody"),t.YNc(3,q,13,6,"tr",32),t.qZA()()),2&i){const e=t.oxw(),n=e.index,a=e.$implicit;t.xp6(1),t.Q6J("ngIf",0==n),t.xp6(2),t.Q6J("ngForOf",a.value)}}function U(i,r){1&i&&(t.TgZ(0,"ngb-panel",27),t.YNc(1,v,4,1,"ng-template",2),t.YNc(2,D,4,2,"ng-template",3),t.qZA()),2&i&&t.MGl("id","staticl1-",r.index+1,"")}function w(i,r){if(1&i&&(t.TgZ(0,"ngb-accordion",28),t.YNc(1,U,3,1,"ngb-panel",12),t.ALo(2,"keyvalue"),t.qZA()),2&i){const e=t.oxw().$implicit;t.Q6J("closeOthers",!0),t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,2,e.value))}}function k(i,r){1&i&&(t.TgZ(0,"ngb-panel",27),t.YNc(1,x,3,1,"ng-template",2),t.YNc(2,w,3,4,"ng-template",3),t.qZA()),2&i&&t.MGl("id","static-",r.index+1,"")}const M=[{path:"",component:(()=>{class i{constructor(e,n,a,o,l,J){this.taskControllerService=e,this.diffTableControllerService=n,this.dpListenControllerService=a,this.alertService=o,this.cdr=l,this.router=J,this.options={autoClose:!1,keepAfterRouteChange:!1},this.oldvaltname="",this.changeDTO={},this.changeDTOArray=[],this.addDTO={},this.addDTOArray=[],this.removeDTO={},this.removeDTOArray=[],this.diffTableDTO={},this.jsondiff={},this.diffTableDTOArray=[],this.taskMainDTO={},this.dplistenentry={},this.taskmainArray=[],this.taskid=0,this.dplistenArray=[],this.runid=0,this.runidselect=0,this.tranid=0,this.addfields={},this.removefields={},this.tabledata={},this.grouped={},this.searchtext=""}ngOnInit(){console.log(Object.keys({a:"somestring",b:42,c:!1})),this.loaddata(),this.tabledata=s(7555)}loaddata(){this.taskControllerService.getTasknainUsingGET().subscribe(e=>{this.taskmainArray=e},e=>{console.log(e)})}loadruniddata(e){this.dpListenControllerService.getRunIdsUsingGET(this.taskid).subscribe(n=>{this.dplistenArray=n,e||(this.runidselect=this.dplistenArray.reduce((a,o)=>Math.max(a,o.runid),0)),this.loadrunid()},n=>{console.log(n)})}loadrunid(){this.dplistenentry=this.dplistenArray.find(e=>e.runid==this.runidselect),this.loaddifftable()}loaddifftable(){this.diffTableDTO.taskid=""+this.dplistenentry.taskid,this.diffTableDTO.runid=this.dplistenentry.runid,this.diffTableControllerService.getDiffDataUsingPOST(this.diffTableDTO).subscribe(e=>{this.diffTableDTOArray=e,this.diffTableDTOArray[0]&&(this.tranid=this.diffTableDTOArray[0].maintranid,this.loadDifferenceTable())},e=>{console.log(e)})}loadDifferenceTable(){for(var e of(this.addDTOArray=[],this.removeDTOArray=[],this.changeDTOArray=[],this.cdr.detectChanges(),this.changeDTOArray=[],this.diffTableDTOArray)){let l="";for(var n of(l=e.difference,l=l.split("(").join("["),l=l.split(")").join("]"),this.jsondiff=JSON.parse(l),e.difference=l,this.jsondiff)){if(console.log(n),console.log(n[0]),"add"==n[0])for(var a of n[2])this.addDTO={},this.addDTO.tname=this.gettname(a[0]),this.addDTO.column=this.getcolumnname(a[0]),this.addDTO.oldval="Missing Tags",this.addDTO.newval=a[1],this.addDTO.maintranid=e.maintranid,this.addDTO.runid=e.runid,this.addDTO.taskid=e.taskid,this.changeDTOArray.push(this.addDTO);if("remove"==n[0])for(var a of n[2])this.removeDTO={},this.removeDTO.tname=this.gettname(a[0]),this.removeDTO.oldval=a[1],this.removeDTO.column=this.getcolumnname(a[0]),this.removeDTO.newval="Missing Tags",this.removeDTO.maintranid=e.maintranid,this.removeDTO.runid=e.runid,this.removeDTO.taskid=e.taskid,this.changeDTOArray.push(this.removeDTO);"change"==n[0]&&(this.changeDTO={},this.changeDTO.tname=this.gettname(n[1]),this.changeDTO.column=this.getcolumnname(n[1]),this.changeDTO.oldval=n[2][0],this.changeDTO.newval=n[2][1],this.changeDTO.maintranid=e.maintranid,this.changeDTO.runid=e.runid,this.changeDTO.taskid=e.taskid,this.changeDTOArray.push(this.changeDTO))}}const o=u.groupBy(this.changeDTOArray,"tname");this.grouped=u.mapValues(o,l=>u.groupBy(l,"maintranid")),this.groupedoriginal=this.grouped}gettname(e){let n=e.replace("INSERTING on FBNK_","");return n=n.replace("UPDATING on FBNK_",""),n=n.replace("DELETING on FBNK_",""),n=n.replace("/row/",""),n.split(":")[0].replace("_",".").replace("001","")}getcolumnname(e){let n=e.replace("INSERTING on FBNK_","");n=n.replace("UPDATING on FBNK_",""),n=n.replace("DELETING on FBNK_",""),n=n.replace("/row/","");let a=n.split(":"),o="";return this.tabledata[a[0].replace("_",".").replace("001","")]?(o=this.tabledata[a[0].replace("_",".").replace("001","")][a[2].toUpperCase()],o):e}onMaintrainid(e,n,a){this.router.navigate(["/reports",{taskid:a,runid:n,tranid:e}])}search(){this.grouped=Object.keys(this.groupedoriginal).filter(e=>e.includes(this.searchtext.toUpperCase())).reduce((e,n)=>(e[n]=this.groupedoriginal[n],e),{})}searchchange(){this.grouped=Object.keys(this.groupedoriginal).filter(e=>e.includes(this.searchtext.toUpperCase())).reduce((e,n)=>(e[n]=this.groupedoriginal[n],e),{}),console.log(this.grouped)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(_.Y),t.Y36(T.Z),t.Y36(Z.u),t.Y36(m.c9),t.Y36(t.sBO),t.Y36(g.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-viewbytran"]],decls:18,vars:9,consts:[["activeIds","static-1",1,"next-accordion",3,"closeOthers"],["id","static-1"],["ngbPanelTitle",""],["ngbPanelContent",""],[1,"row"],[1,"col-sm-12"],["cardTitle","Comparision",3,"options"],[1,"col-md-12"],[1,"input-group"],["type","text","id","m-search","name","searchtext","id","searchtext","placeholder","Search . . .",1,"form-control",3,"ngModel","keydown","ngModelChange"],[1,"input-group-append","search-btn","btn","btn-primary"],[1,"feather","icon-search","input-group-text",3,"click"],[3,"id",4,"ngFor","ngForOf"],["href","javascript:"],[1,"col-md-6"],[1,"form-group"],["for","exampleFormControlSelect1"],["name","taskid","id","taskid",1,"form-select",3,"ngModel","ngModelChange"],["value","0","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","exampleFormControlSelect2"],["name","runidselect","id","runidselect",1,"form-select",3,"ngModel","ngModelChange"],[1,"table-responsive"],[1,"table","table-bordered","table-sm"],[1,"table-primary"],[1,"table-light"],[3,"value"],[3,"id"],[1,"next-accordion",3,"closeOthers"],[1,"feather","icon-arrow-right",3,"click"],[1,"table","table-bordered","table-sm",2,"margin-bottom","0px"],[3,"ngIf"],["class","table-light",4,"ngFor","ngForOf"],["colspan","3"],["type","text","readonly","",2,"width","96%","text-align","left","vertical-align","middle","color","blue",3,"value"],["type","text","readonly","",2,"width","96%","text-align","left","vertical-align","middle","color","rgb(5, 92, 57)",3,"value"],["type","text","readonly","",2,"width","96%","text-align","left","vertical-align","middle","color","red",3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"ngb-accordion",0)(1,"ngb-panel",1),t.YNc(2,f,3,0,"ng-template",2),t.YNc(3,O,78,18,"ng-template",3),t.qZA()(),t.TgZ(4,"div",4),t._UZ(5,"br"),t.TgZ(6,"div",4)(7,"div",5)(8,"app-card",6)(9,"div",4)(10,"div",7)(11,"div",8)(12,"input",9),t.NdJ("keydown",function(){return n.searchchange()})("ngModelChange",function(o){return n.searchtext=o}),t.qZA(),t.TgZ(13,"span",10)(14,"i",11),t.NdJ("click",function(){return n.search()}),t.qZA()()(),t.TgZ(15,"ngb-accordion",0),t.YNc(16,k,3,1,"ngb-panel",12),t.ALo(17,"keyvalue"),t.qZA()()()()()()()),2&e&&(t.Q6J("closeOthers",!0),t.xp6(8),t.Q6J("options",!1),t.xp6(4),t.Udp("width","330px"),t.Q6J("ngModel",n.searchtext),t.xp6(3),t.Q6J("closeOthers",!0),t.xp6(1),t.Q6J("ngForOf",t.lcZ(17,7,n.grouped)))},dependencies:[c.sg,c.O5,d.YN,d.Kr,d.Fj,d.EJ,d.JJ,d.On,y.A,p.gY,p.Gk,p.Cu,p.gW,c.Nd]}),i})()}];let N=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.Bz.forChild(M),g.Bz]}),i})();var V=s(700);let F=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[c.ez,m.nM,N,V.m,p.lQ,p.Gs]}),i})()}}]);